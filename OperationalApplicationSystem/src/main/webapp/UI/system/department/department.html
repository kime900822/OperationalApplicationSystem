<script type="text/javascript">
function getUnameOfDeparment(a){
	var id=$.CurrentNavtab.find(a).val();

	    		BJUI.ajax('doajax', {
	    		    url: 'getUserByID.action',
	    		    loadingmask: true,
	    		    data:{uid:id},
	    		    okCallback: function(json, options) {
	    		    	if(json.length>0){
	    		    		$.CurrentNavtab.find('#department_edit_uname').val(json[0].name).change();
	    		    	}                         
	    		    	else{
	    		    		$.CurrentNavtab.find(a).val(''); 	
	    		    		$.CurrentNavtab.find('#department_edit_uname').val('');
	    		    		BJUI.alertmsg('error','无对应数据'); 	    			
	    		    	}
	    		    }
	    		})			
}

</script>


<div class="bjui-pageHeader" style="background-color:#fefefe; border-bottom:none;">

</div>
<div class="bjui-pageContent" id="div-user">
    <table class="table table-bordered" id="datagrid-edit-filter" data-toggle="datagrid" data-options="{
        height: '100%',
        gridTitle : '部门维护',
        showToolbar: true,
        dataType: 'jsonp',
        toolbarItem: 'add,edit,del,save,cancel,|,refresh',
        dataUrl: 'queryDepartment.action',
        delUrl:'deleteDepartment.action',
        editUrl: 'saveDepartment.action',
        paging: {pageSize:30, pageCurrent:1},
        showCheckboxcol: true,
        linenumberAll: true,
        filterThead: false,
        contextMenuB: true,
        hScrollbar: true
    }">
        <thead>
            <tr>
            	<th data-options="{name:'id',width:350,align:'center',finalWidth:'true',hide:'true'}" ></th>
            	<th data-options="{name:'did',width:150,align:'center',finalWidth:'true'}" >BU ID</th>
				<th data-options="{name:'name',width:350,align:'center',finalWidth:'true'}">Deparment</th>
				<th data-options="{name:'uid',width:150,align:'center',finalWidth:'true',attrs:{onchange:'getUnameOfDeparment(this);'},rule:'required'}" >Name ID</th>
				<th data-options="{name:'uname',width:350,align:'center',finalWidth:'true',attrs:{readonly:'true',id:'department_edit_uname'}}">Name</th>
            </tr>
        </thead>
    </table>
</div>